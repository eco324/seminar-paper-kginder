---
title: "Data Appendix to \"Smith Compost Analysis\""
author: "Kate Ginder"
output: 
  pdf_document:
    toc: true
    number_sections: true
---
```{r setup, echo = F, message = F}
knitr::opts_chunk$set(results = 'asis', cache = F)
library(tidyverse)
library(summarytools)
st_options(plain.ascii = F,
           style = "rmarkdown",
           footnote = NA,
           subtitle.emphasis = F,
           dfSummary.silent = T,
           dfSummary.valid.col = F,
           tmp.img.dir = "./tmp",
           dfSummary.style = "grid")

#The following custom function simplifies the process of writing dfSummaries to html files
export_summary_table <- function(dfSummary_output){
  data_info <- attr(dfSummary_output, "data_info")
  ds_name <- data_info$Data.frame
  print(dfSummary_output,
      file = str_c("output/", ds_name, "_summary.html"),
      method = "browser",
      report.title = ds_name)
}
```

```{r}
library(dummies)
library(caret)
```


```{r set dfSummary css style, echo = F, include = F}
st_css()
```


# Appendix description
*Your Data Appendix should begin with a brief statement explaining its purpose like the following one.*

This Data Appendix documents the data used in "Smith Compost Anlysis". It was prepared in a Rmarkdown document that contains both the documentation and the R code used to prepare the data used in the final estimation. It also includes descriptive statistics for both the original data and the final dataset, with a discussion of any issues of note.  This data is a time series and will record pounds of compost in a college dinning hall.

The datasets used directly by the final analysis are saved in `processed-data/` at the end of this file.

*Note: this document structure will require you to re-run steps of your analysis multiple times. If your code takes a long time, please come talk with me about strategies to reduce run time or save earlier results.*



# Raw data
*Each dataset you use will have its own documentation section. The next subsection in this document (Dataset description) is a template. You can copy this section and paste it into your document each time you need to add a section for a new dataset. Note that each line in the Dataset description section __must__ end with two spaces.* 

This section documents the data sets used in this analysis.

## Dataset description
**Citation:** Put citation here in APA or other consistent format that you will use throughout the project. Include a hyperlink if applicable.  
**Date Downloaded:** 04/17/2020  
**Filename:** Compost Tracker 3.0.xlsx. 
**Unit of observation:** amount of compost recorded in dinning halls daily  
**Dates covered:**  February 2020 - April 2020  

### To obtain a copy

To obtain a copy of this data set please contact Susan Sayre at ssayre@smith.edu

### Importable version

**Filename:** importable-data/Raw Data Seminar Paper/Compost Tracker 6.0.csv

The following changes were made to create the importable files.

1.The file was originally opened in excel on a Mac
2.The header reading "Composting Feb & April" was deleted.  It was causing the variable names to import incorrectly.
3. Variable names were edited to allow R to read them
4. The document was then saved as a csv file

### Variable descriptions

The following data is from two of the Smith College dinning serviouses

- **dates:** Date of the month.  
- **Dayoftheweek:** Day of the week the meal is served on.
- **#ofplatesking:** Number of plates per night used in King dinning hall. 
- **lbcompostingking:** Pounds of compost per night King dinning hall.
- **#ofplatescutter:** Number of plates per night used in Cutter dinning hall. 
- **lbcompostingcutter:** Pounds of compost per night Cutter dinning hall.
- **Meal_number:** Rotating menu cycle the coordinates to a different number. 

### Data import code and summary

*Once you've described the variables, enter an R chunk by selecting Code -> Insert Chunk, or Ctrl+Alt+I, give it a name to describe the dataset you are importing. After importing, export a dataframe summary using the command.*


```{r reading in variable names}
library(readr)
importable_data <- read_csv("Raw Data Seminar Paper/importable_data.csv")
View(importable_data)


Compost_data <- read_csv("Raw Data Seminar Paper/importable_data.csv")  %>%
  rename(king_plates = `#ofplatesKing`,
        king_compost = lbcompostKing,
        cutter_plates = `#ofplatescutter`,
        cutter_compost = lbcompostCutter)  %>%
pivot_longer(contains("_"), names_to = c("house","variable"), names_sep = '_', values_to = "values") %>%
  pivot_wider(names_from = "variable", values_from = "values") %>%
  mutate(date_var = as.Date(dates, "%m/%d/%y")) %>%
  mutate(cycle = case_when(date_var <= as.Date("2020-03-01") ~ 1,
date_var <= as.Date("2020-04-04") ~ 2,
date_var <= as.Date("2020-05-03") ~ 3))
View(Compost_data)

```


# Analysis Variables

This section should include a description of all the variables that are used in your final analysis. At the end of the section, you should save all of these variables in the processed_data folder of your repository.

Variables used in the final analysis are

- **date_var:** Date of the month read as a numerical value.  
- **house:** House variable, King or Cutter.
- **plates:** Number of plates counted per meal.
- **compost:** Pounds of compost collected per night.
- **cycle:** Classifies the rotating menu into three distinct cycles.
- **poster_date:** Dummy variable for no posters (poster date 0: 2/2 - 4/4) and posters poster date 1: 4/5 - 5/2.

# Summary Statistics

```{r summary stats, creating dummy variable}
summary(Compost_data)

# create dummy variable
Compost_data <- Compost_data %>%
  mutate(poster_date = case_when(date_var <= as.Date("2020-04-04") ~ 0,
date_var <= as.Date("2020-05-2") ~ 1))
```


```{r summary stats for King}
king_data <- Compost_data %>% filter(house == "king")

summary(filter(king_data, cycle == 1))
summary(filter(king_data, cycle == 3))
```



```{r}
cutter_data <- Compost_data %>% filter(house == "cutter")

summary(filter(cutter_data, cycle == 1))
summary(filter(cutter_data, cycle == 3))
```


```{r, Cycle 1 King and Cutter}
ggplot(data = filter(Compost_data, cycle == 1), aes(plates, compost, color = house)) + geom_point() + geom_smooth(method = "lm")
```

```{r, Cycle 2 King and Cutter}
ggplot(data = filter(Compost_data, cycle == 3), aes(plates, compost, color = house)) + geom_point() + geom_smooth(method = "lm")
```

# Hisograms and Frequency Tables

```{r}
hist(data = filter(Compost_data, cycle ==1), aes(compost))

hist(Compost_data$compost)
```



```{r}
hist(king_data$compost)
hist(filter(king_data, cycle == 1)$compost))
```




# Densisty Plot

```{r}

```



# Regresssion


```{r}
cor(king_data$compost, king_data$poster_date)
```


```{r}
cor((filter(king_data, cycle == 1)$compost), king_data$poster_date)

```

```{r}
linearMod = lm(compost ~ poster_date, king_data = data)
print(linearMod)
```





# Discussion of Data

 

  


































